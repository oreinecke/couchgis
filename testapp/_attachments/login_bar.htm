<!DOCTYPE html>

<html lang="de">
  <head>
    <title>Ãœbersicht</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <script src="script/jquery-1.10.2.js"></script>
    <script src="script/jquery.couch.js"></script>

<script>
$(document).ready(function() {
  var log={
    success: function(resp) {
      if (resp.userCtx.name!==null || resp.userCtx.roles && resp.userCtx.roles.indexOf("_admin")>=0) {
        $("#logout").show();
        href=$("#logout a");
        // expect admin party if name==null
        href.text(resp.userCtx.name||"Administrator (keine Benutzer festgelegt)");
        // link to futon user doc
        if (resp.userCtx.name)
          href.attr({href:"/_utils/document.html?_users/org.couchdb.user:"+href.text()});
        else
          $("#logout :submit").hide();
        $("#login").hide();
        $("#login b").hide();
      } else {
        $("#login").show();
        $("#logout").hide();
      }
    }
  };
  $.couch.session(log);
  $("#login").submit(function(e) {
    e.preventDefault();
    var login={
      name:     $("#login :text").val(),
      password: $("#login :password").val(),
      success:function(resp) {
        log.success({userCtx:{name:this.name}});
      },
      error:function() {
        $("#login b").show();
      }
    };
    $.couch.login(login);
  });
  $("#logout").submit(function(e) {
    e.preventDefault();
    $.couch.logout();
    log.success({userCtx:{name:null}});
  });
});
</script>

  </head>
  <body style="margin:0; padding:0">

  <form id="login" style="display:none" autocomplete="on">
    Benutzername: <input type="text" size="7">
    Kennwort: <input type="password" size="7">
    <input type="submit" value="Anmelden">
    <b style="display:none"><br>Benutzername/Kennwort falsch!!</b>
  </form>
  <form id="logout" style="display:none">
    Angemeldet als <a target="_top">?</a> <input type="submit" value="Abmelden">
  </form>

  </body>
</html>
